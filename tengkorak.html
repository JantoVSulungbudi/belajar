<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Babylon.js AR-lite Skull Placement</title>
<script src="https://cdn.babylonjs.com/babylon.js"></script>
<script src="https://cdn.babylonjs.com/loaders/babylonjs.loaders.min.js"></script>

<style>
  html, body { width: 100%; height: 100%; margin: 0; overflow: hidden; }
  video, canvas { position: absolute; top: 0; left: 0; width: 100%; height: 100%; }
  video { object-fit: cover; z-index: -1; }
  canvas { z-index: 0; }
</style>
</head>

<body>
  <video id="cameraFeed" autoplay playsinline></video>
  <canvas id="renderCanvas"></canvas>

<script>
const video = document.getElementById("cameraFeed");
const canvas = document.getElementById("renderCanvas");
const engine = new BABYLON.Engine(canvas, true);

// ---- Start phone camera for background ----
navigator.mediaDevices.getUserMedia({ video: { facingMode: "environment" } })
  .then(stream => { video.srcObject = stream; })
  .catch(err => { alert("Camera access denied: " + err); });

// ---- Scene setup ----
const scene = new BABYLON.Scene(engine);
scene.clearColor = new BABYLON.Color4(0, 0, 0, 0);   // transparent so camera shows through

// Device orientation camera for AR-lite style
//const camera = new BABYLON.DeviceOrientationCamera("DevOrCam", new BABYLON.Vector3(0, 1, -5), scene); 
var camera = new BABYLON.ArcRotateCamera("camera", BABYLON.Tools.ToRadians(0), BABYLON.Tools.ToRadians(57.3), 10, BABYLON.Vector3.Zero(), scene);
camera.attachControl(canvas, true);

// Basic light
const light = new BABYLON.HemisphericLight("light", new BABYLON.Vector3(0, 1, 0), scene);
light.intensity = 1.2;
BABYLON.ImportMeshAsync("scenes/skull.babylon", scene, { meshNames: ""}).then(function(result) {
    result.meshes[0].scaling = new BABYLON.Vector3(0.1, 0.1, 0.1);
});
  
/*
// Tap to place the skull in front of the camera
canvas.addEventListener("click", () => {
    const forward = camera.getDirection(BABYLON.Axis.Z);
    const placePos = camera.position.add(forward.scale(3));  // 3 units ahead

    BABYLON.SceneLoader.ImportMesh("", "scenes/", "skull.babylon", scene, (meshes) => {
        const skull = meshes[0];
        skull.position = placePos;
        skull.scaling = new BABYLON.Vector3(0.02, 0.02, 0.02); // adjust size as needed
        skull.rotation.y = Math.PI; // adjust orientation if required

        // slow rotation to show itâ€™s loaded
        skull.metadata = { rotate: true, speed: 0.002 };
    });
});

// Rotate any placed skulls
scene.onBeforeRenderObservable.add(() => {
    scene.meshes.forEach(mesh => {
        if (mesh.metadata && mesh.metadata.rotate) {
            mesh.addRotation(0, mesh.metadata.speed, 0);
        }
    });
});
*/
// ---- Render loop ----
engine.runRenderLoop(() => { scene.render(); });
window.addEventListener("resize", () => engine.resize());
</script>
</body>
</html>





